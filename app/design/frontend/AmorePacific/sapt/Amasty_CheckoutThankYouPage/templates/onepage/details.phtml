<?php
/**
* @author Amasty Team
* @copyright Copyright (c) 2022 Amasty (https://www.amasty.com)
* @package Amasty_CheckoutThankYouPage
*/

use Amasty\Rewards\Api\Data\SalesQuote\OrderInterface;

?>
<?php
/**
 * @var $block Amasty\CheckoutThankYouPage\Block\Onepage\Success\Details
 * @var $escaper Magento\Framework\Escaper
 */
$order = $block->getOrder();
$shippingMethod = $order->getShippingMethod(true);
$items = $order->getAllVisibleItems();
$product = null;
$count = 0;
/** @var \Magento\Sales\Model\Order\Item $item */
foreach ($items as $item) {
    if (!$count) {
        $product = $item->getProduct();
    }
    $count++;
}
/** @var \Satp\Sales\ViewModel\OrderInfo $viewModel */
$viewModel = $block->getData('view_model_info');

$amount = (float)$order->getData(OrderInterface::POINTS_EARN);
$amount = $amount ? round($amount, 2) : 0;
?>

<ul class="order-info">
    <li class="shipping-method">
        <span class="label"><?= __('Shipping Method') ?></span>
        <span class="value"><?= $order->getShippingDescription() ?><br/>
            <span class="address">
                <?= $viewModel->getFormattedAddress($order->getShippingAddress()) ?>
            </span>
        </span>
    </li>
    <li>
        <span class="label"><?= __('Date') ?></span>
        <span class="value"><?= $escaper->escapeHtml(
                $block->formatDate($order->getCreatedAt(), \IntlDateFormatter::MEDIUM, true)
            ) ?></span>
    </li>
    <li>
        <span class="label"><?= __('Product') ?></span>
        <span class="value"><?= $count > 1 ? __('%1 + %2 more products', $product->getName(), $count - 1) : $product->getName() ?></span>
    </li>
    <li class="payment-method">
        <span class="label"><?= __('Payment') ?></span>
        <span class="value"><?= $order->formatPrice($order->getGrandTotal()) ?><br/>
            <?php
            $method = $order->getPayment()->getMethodInstance();
            $methodTitle = $method ? $method->getTitle() : '';
            ?>
            <span><?= $methodTitle ?></span>
        </span>
    </li>
    <li>
        <span class="label"><?= __('Point') ?></span>
        <span class="value"><?= __('%1P', $amount) ?></span>
    </li>
</ul>
