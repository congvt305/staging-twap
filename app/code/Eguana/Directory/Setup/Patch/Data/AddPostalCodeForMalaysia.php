<?php
/**
 * Copyright Â© Magento, Inc. All rights reserved.
 * See COPYING.txt for license details.
 */

namespace Eguana\Directory\Setup\Patch\Data;

use Eguana\Directory\Setup\RegionCityZipcodeDataInstaller;
use Eguana\Directory\Setup\RegionCityZipcodeDataInstallerFactory;
use Magento\Framework\Setup\ModuleDataSetupInterface;
use Magento\Framework\Setup\Patch\DataPatchInterface;

/**
 * Patch is mechanism, that allows to do atomic upgrade data changes
 */
class AddPostalCodeForMalaysia implements DataPatchInterface
{

    /**
     * @var ModuleDataSetupInterface
     */
    private ModuleDataSetupInterface $moduleDataSetup;
    /**
     * @var RegionCityZipcodeDataInstallerFactory
     */
    private RegionCityZipcodeDataInstallerFactory $regionCityZipcodeDataInstallerFactory;

    /**
     * AddNewDataForMalaysia constructor.
     * @param ModuleDataSetupInterface $moduleDataSetup
     * @param RegionCityZipcodeDataInstallerFactory $regionCityZipcodeDataInstallerFactory
     */
    public function __construct(
        ModuleDataSetupInterface $moduleDataSetup,
        RegionCityZipcodeDataInstallerFactory $regionCityZipcodeDataInstallerFactory

    ) {
        $this->moduleDataSetup = $moduleDataSetup;
        $this->regionCityZipcodeDataInstallerFactory = $regionCityZipcodeDataInstallerFactory;
    }

    /**
     * Do Upgrade
     *
     * @return void
     */
    public function apply()
    {
        $this->moduleDataSetup->startSetup();
        $this->deleteExistingRegionData();
        $regionCityDataInstaller = $this->regionCityZipcodeDataInstallerFactory->create();
        $regionCityDataInstaller->addCountryRegionsCitiesWithZipcode($this->moduleDataSetup->getConnection(), $this->getDataForMalaysia());
        $this->moduleDataSetup->endSetup();
    }

    /**
     * {@inheritdoc}
     */
    public function getAliases(): array
    {
        return [];
    }

    /**
     * {@inheritdoc}
     */
    public static function getDependencies(): array
    {
        return [];
    }

    /**
     * @return array[]
     */
    public function getDataForMalaysia(): array
    {
        return [
            ["MY","JHR","Johor", [
                ["79000","Iskandar Puteri","MY-001"],
                ["80000","Johor Bahru","MY-002"],
                ["81000","Kulai","MY-003"],
                ["81400","Senai","MY-004"],
                ["81440","Bandar Tenggara","MY-005"],
                ["81450","Gugusan Taib Andak","MY-006"],
                ["81500","Pekan Nenas","MY-007"],
                ["81550","Gelang Patah","MY-008"],
                ["81550","Pulau Satu","MY-009"],
                ["81600","Pengerang","MY-010"],
                ["81700","Pasir Gudang","MY-011"],
                ["81750","Masai","MY-012"],
                ["81800","Ulu Tiram","MY-013"],
                ["81850","Layang-Layang","MY-014"],
                ["81920","Ayer Tawar 2","MY-015"],
                ["81930","Bandar Penawar","MY-016"],
                ["82000","Pontian","MY-017"],
                ["82100","Ayer Baloi","MY-018"],
                ["82300","Kukup","MY-019"],
                ["83000","Batu Pahat","MY-020"],
                ["83100","Rengit","MY-021"],
                ["83200","Senggarang","MY-022"],
                ["83300","Seri Gading","MY-023"],
                ["83400","Seri Medan","MY-024"],
                ["83500","Parit Sulong","MY-025"],
                ["83600","Semerah","MY-026"],
                ["83700","Yong Peng","MY-027"],
                ["84000","Muar","MY-028"],
                ["84150","Parit Jawa","MY-029"],
                ["84400","Sungai Mati","MY-030"],
                ["84500","Panchor","MY-031"],
                ["84700","Gerisek","MY-032"],
                ["84800","Bukit Gambir","MY-032"],
                ["84900","Tangkak","MY-033"],
                ["85000","Segamat","MY-034"],
                ["85100","Batu Anam","MY-035"],
                ["85200","Jementah","MY-036"],
                ["85300","Labis","MY-037"],
                ["85400","Chaah","MY-038"],
                ["86000","Kluang","MY-039"],
                ["86100","Ayer Hitam","MY-040"],
                ["86200","Simpang Rengam","MY-041"],
                ["86300","Rengam","MY-042"],
                ["86400","Parit Raja","MY-043"],
                ["86500","Bekok","MY-044"],
                ["86600","Paloh","MY-045"],
                ["86700","Kahang","MY-046"],
                ["86800","Mersing","MY-047"],
                ["86900","Endau","MY-048"],
            ]],
            ["MY","KDH","Kedah", [
                ["5000","Alor Setar","MY-049"],
                ["6000","Jitra","MY-050"],
                ["6010","Changloon","MY-051"],
                ["6050","Bukit Kayu Hitam","MY-052"],
                ["6100","Kodiang","MY-053"],
                ["6150","Ayer Hitam","MY-054"],
                ["6200","Kepala Batas","MY-055"],
                ["6300","Kuala Nerang","MY-056"],
                ["6400","Pokok Sena","MY-057"],
                ["6500","Langgar","MY-058"],
                ["6600","Kuala Kedah","MY-060"],
                ["6650","Simpang Empat","MY-061"],
                ["6700","Pendang","MY-062"],
                ["6800","Kota Sarang Semut","MY-063"],
                ["6900","Yan","MY-064"],
                ["7000","Langkawi","MY-065"],
                ["8000","Sungai Petani","MY-066"],
                ["8100","Bedong","MY-067"],
                ["8200","Sik","MY-068"],
                ["8300","Gurun","MY-069"],
                ["8320","Jeniang","MY-070"],
                ["8400","Merbok","MY-071"],
                ["8500","Kota Kuala Muda","MY-072"],
                ["8600","Sungai Petani","MY-073"],
                ["8700","Jeniang","MY-074"],
                ["9000","Kulim","MY-075"],
                ["9100","Baling","MY-076"],
                ["9110","Kuala Pegang","MY-077"],
                ["9200","Kupang","MY-078"],
                ["9300","Kuala Ketil","MY-079"],
                ["9400","Padang Serai","MY-080"],
                ["9600","Lunas","MY-081"],
                ["9700","Karangan","MY-082"],
                ["9800","Serdang","MY-083"],
                ["14290","Bandar Baharu","MY-084"],
            ]],
            ["MY","KTN","Kelantan", [
                ["15000","Kota Bharu","MY-085"],
                ["16020","Bachok","MY-086"],
                ["16040","Wakaf Bharu","MY-087"],
                ["16080","Tumpat","MY-088"],
                ["16400","Melor","MY-089"],
                ["16450","Ketereh","MY-090"],
                ["16500","Kem Desa Pahlawan","MY-091"],
                ["16600","Pulai Chondong","MY-092"],
                ["16700","Cherang Ruku","MY-093"],
                ["16800","Pasir Puteh","MY-094"],
                ["16810","Selising","MY-095"],
                ["17000","Pasir Mas","MY-096"],
                ["17200","Rantau Panjang","MY-097"],
                ["17500","Tanah Merah","MY-098"],
                ["17600","Jeli","MY-099"],
                ["17610","Kuala Balah","MY-100"],
                ["17700","Ayer Lanas","MY-101"],
                ["18000","Kuala Krai","MY-102"],
                ["18200","Dabong","MY-103"],
                ["18300","Gua Musang","MY-104"],
                ["18400","Temangan","MY-105"],
                ["18500","Machang","MY-106"],
            ]],
            ["MY","MLK","Melaka", [
                ["75000","Melaka","MY-107"],
                ["75450","Ayer Keroh","MY-108"],
                ["76100","Durian Tunggal","MY-109"],
                ["76200","Kem Trendak","MY-110"],
                ["76300","Sungai Udang","MY-111"],
                ["76400","Tanjong Kling","MY-112"],
                ["77000","Jasin","MY-113"],
                ["77100","Asahan","MY-114"],
                ["77200","Bemban","MY-115"],
                ["77300","Merlimau","MY-116"],
                ["77400","Sungai Rambai","MY-117"],
                ["77500","Selandar","MY-118"],
                ["78000","Alor Gajah","MY-119"],
                ["78100","Lubok China","MY-120"],
                ["78200","Kuala Sungai Baru","MY-121"],
                ["78300","Masjid Tanah","MY-122"],
            ]],
            ["MY","NSN","Negeri Sembilan", [
                ["70000","Seremban","MY-123"],
                ["71000","Port Dickson","MY-124"],
                ["71050","Si Rusa","MY-125"],
                ["71100","Rantau","MY-126"],
                ["71150","Linggi","MY-127"],
                ["71200","Rantau","MY-128"],
                ["71300","Rembau","MY-129"],
                ["71350","Kota","MY-130"],
                ["71500","Tanjong Ipoh","MY-131"],
                ["71600","Kuala Klawang","MY-132"],
                ["71700","Mantin","MY-133"],
                ["71760","Bandar Enstek","MY-134"],
                ["71800","Nilai","MY-135"],
                ["71900","Labu","MY-136"],
                ["71960","Port Dickson","MY-137"],
                ["72000","Kuala Pilah","MY-138"],
                ["72100","Bahau","MY-139"],
                ["72120","Bandar Seri Jempol","MY-140"],
                ["72200","Batu Kikir","MY-141"],
                ["72300","Simpang Pertang","MY-142"],
                ["72400","Simpang Durian","MY-143"],
                ["73000","Tampin","MY-144"],
                ["73100","Johol","MY-145"],
                ["73200","Gemencheh","MY-146"],
                ["73400","Gemas","MY-147"],
                ["73430","Pusat Bandar Palong","MY-148"],
                ["73500","Rompin","MY-149"],
            ]],
            ["MY","PHG","Pahang", [
                ["69000","Genting Highlands","MY-150"],
                ["25000","Kuantan","MY-151"],
                ["26090","Bukit Goh","MY-152"],
                ["26200","Sungai Lembing","MY-153"],
                ["26300","Gambang","MY-154"],
                ["26400","Bandar Pusat Jengka","MY-155"],
                ["26500","Maran","MY-156"],
                ["26600","Pekan","MY-157"],
                ["26700","Muadzam Shah","MY-158"],
                ["26800","Kuala Rompin","MY-159"],
                ["26900","Bandar Tun Abdul Razak","MY-160"],
                ["27000","Jerantut","MY-161"],
                ["27030","Damak","MY-162"],
                ["27100","Padang Tengku","MY-163"],
                ["27200","Kuala Lipis","MY-164"],
                ["27300","Benta","MY-165"],
                ["27400","Dong","MY-166"],
                ["27500","Raub","MY-167"],
                ["27650","Sungai Koyan","MY-168"],
                ["27660","Sega","MY-169"],
                ["28000","Temerloh","MY-170"],
                ["28050","Kuala Krau","MY-171"],
                ["28100","Chenor","MY-172"],
                ["28200","Bandar Bera","MY-173"],
                ["28300","Triang","MY-174"],
                ["28340","Kemayan","MY-175"],
                ["28400","Mentakab","MY-176"],
                ["28500","Lanchang","MY-177"],
                ["28600","Karak","MY-178"],
                ["28700","Bentong","MY-179"],
                ["28800","Lurah Bilut","MY-180"],
                ["39000","Tanah Rata","MY-181"],
                ["39100","Brinchang","MY-182"],
                ["39200","Ringlet","MY-183"],
                ["49000","Bukit Fraser","MY-184"],
            ]],
            ["MY","PNG","Pulau Pinang", [
                ["10000","Pulau Pinang","MY-185"],
                ["11000","Balik Pulau","MY-186"],
                ["11100","Batu Ferringhi","MY-187"],
                ["11200","Tanjung Bungah","MY-188"],
                ["11300","Penang Hill","MY-189"],
                ["11500","Ayer Itam","MY-190"],
                ["11600","Jelutong","MY-191"],
                ["11700","Gelugor","MY-192"],
                ["11800","USM Pulau Pinang","MY-193"],
                ["11900","Bayan Lepas","MY-194"],
                ["11960","Batu Maung","MY-195"],
                ["12000","Butterworth","MY-196"],
                ["13100","Penaga","MY-197"],
                ["13200","Kepala Batas","MY-198"],
                ["13300","Tasek Gelugor","MY-199"],
                ["13500","Permatang Pauh","MY-200"],
                ["13600","Perai","MY-201"],
                ["14000","Bukit Mertajam","MY-202"],
                ["14100","Simpang Ampat","MY-203"],
                ["14200","Sungai Jawi","MY-204"],
            ]],
            ["MY","PRK","Perak", [
                ["30000","Ipoh","MY-205"],
                ["31000","Batu Gajah","MY-206"],
                ["31050","Sungai Siput","MY-207"],
                ["31150","Ulu Kinta","MY-208"],
                ["31200","Chemor","MY-209"],
                ["31250","Tanjong Rambutan","MY-210"],
                ["31300","Kampung Kepayang","MY-211"],
                ["31550","Pusing","MY-212"],
                ["31600","Gopeng","MY-213"],
                ["31700","Malim Nawar","MY-214"],
                ["31750","Tronoh","MY-215"],
                ["31800","Tanjong Tualang","MY-216"],
                ["31850","Jeram","MY-217"],
                ["31900","Kampar","MY-218"],
                ["32000","Sitiawan","MY-219"],
                ["32040","Seri Manjung","MY-220"],
                ["32100","TLDM Lumut","MY-221"],
                ["32200","Lumut","MY-222"],
                ["32300","Pangkor","MY-223"],
                ["32400","Ayer Tawar","MY-224"],
                ["32500","Changkat Keruing","MY-225"],
                ["32600","Bota","MY-226"],
                ["32610","Bandar Seri Iskandar","MY-227"],
                ["32700","Bruas","MY-227"],
                ["32800","Parit","MY-229"],
                ["32900","Lambor Kanan","MY-230"],
                ["33000","Kuala Kangsar","MY-231"],
                ["33100","Pengkalan Hulu","MY-232"],
                ["33200","Intan","MY-233"],
                ["33300","Gerik","MY-234"],
                ["33400","Lenggong","MY-235"],
                ["33500","Sauk","MY-236"],
                ["33600","Enggor","MY-237"],
                ["33700","Padang Rengas","MY-238"],
                ["33800","Manong","MY-239"],
                ["34000","Taiping","MY-240"],
                ["34100","Selama","MY-241"],
                ["34140","Rantau Panjang","MY-242"],
                ["34200","Parit Buntar","MY-243"],
                ["34250","Tanjong Piandang","MY-244"],
                ["34300","Bagan Serai","MY-245"],
                ["34350","Kuala Kurau","MY-246"],
                ["34400","Simpang Ampat Semanggol","MY-247"],
                ["34500","Batu Kurau","MY-248"],
                ["34600","Kamunting","MY-249"],
                ["34650","Kuala Sepetang","MY-250"],
                ["34700","Simpang","MY-251"],
                ["34750","Matang","MY-252"],
                ["34800","Trong","MY-253"],
                ["34850","Changkat Jering","MY-254"],
                ["34900","Pantai Remis","MY-255"],
                ["35000","Tapah","MY-256"],
                ["35300","Chenderiang","MY-257"],
                ["35350","Temoh","MY-258"],
                ["35400","Tapah Road","MY-259"],
                ["35500","Bidor","MY-260"],
                ["35600","Sungkai","MY-261"],
                ["35700","Trolak","MY-262"],
                ["35800","Slim River","MY-263"],
                ["35900","Tanjong Malim","MY-264"],
                ["35950","Behrang Stesen","MY-265"],
                ["36000","Teluk Intan","MY-266"],
                ["36100","Bagan Datoh","MY-267"],
                ["36110","Teluk Intan","MY-268"],
                ["36200","Selekoh","MY-269"],
                ["36300","Sungai Sumun","MY-270"],
                ["36400","Hutan Melintang","MY-271"],
                ["36500","Ulu Bernam","MY-272"],
                ["36600","Chenderong Balai","MY-273"],
                ["36700","Langkap","MY-274"],
                ["36750","Chikus","MY-275"],
                ["36800","Kampung Gajah","MY-276"],
            ]],
            ["MY","PLS","Perlis", [
                ["1000","Kangar","MY-277"],
                ["2000","Kuala Perlis","MY-278"],
                ["2100","Padang Besar","MY-279"],
                ["2200","Kaki Bukit","MY-280"],
                ["2600","Arau","MY-281"],
                ["2700","Simpang Ampat","MY-282"],
            ]],
            ["MY","SGR","Selangor", [
                ["40000","Shah Alam","MY-283"],
                ["41000","Klang","MY-284"],
                ["42000","Pelabuhan Klang","MY-285"],
                ["42200","Kapar","MY-286"],
                ["42300","Bandar Puncak Alam","MY-287"],
                ["42425","Telok Panglima Garang","MY-288"],
                ["42600","Jenjarom","MY-289"],
                ["42700","Banting","MY-290"],
                ["42800","Tanjong Sepat","MY-291"],
                ["42920","Pulau Indah","MY-292"],
                ["42960","Pulau Carey","MY-293"],
                ["43000","Kajang","MY-294"],
                ["43100","Hulu Langat","MY-295"],
                ["43200","Cheras","MY-296"],
                ["43300","Seri Kembangan","MY-297"],
                ["43400","Serdang","MY-298"],
                ["43500","Semenyih","MY-299"],
                ["43600","Bandar Baru Bangi","MY-300"],
                ["43700","Beranang","MY-301"],
                ["43800","Dengkil","MY-301"],
                ["43900","Sepang","MY-313"],
                ["43950","Sungai Pelek","MY-304"],
                ["44000","Kuala Kubu Baru","MY-305"],
                ["44100","Kerling","MY-306"],
                ["44200","Rasa","MY-307"],
                ["44300","Batang Kali","MY-308"],
                ["45000","Kuala Selangor","MY-309"],
                ["45100","Sungai Ayer Tawar","MY-310"],
                ["45200","Sabak Bernam","MY-311"],
                ["45300","Sungai Besar","MY-312"],
                ["45400","Sekinchan","MY-313"],
                ["45500","Tanjong Karang","MY-314"],
                ["45600","Bestari Jaya","MY-315"],
                ["45700","Bukit Rotan","MY-316"],
                ["45800","Jeram","MY-317"],
                ["46000","Petaling Jaya","MY-318"],
                ["47100","Puchong","MY-319"],
                ["47200","Subang Jaya","MY-320"],
                ["48000","Rawang","MY-321"],
                ["48050","Kuang","MY-322"],
                ["48100","Batu Arang","MY-333"],
                ["48200","Serendah","MY-334"],
                ["63000","Cyberjaya","MY-335"],
                ["64000","KLIA","MY-336"],
                ["68000","Ampang","MY-337"],
                ["68100","Batu Caves","MY-338"],
            ]],
            ["MY","TRG","Terengganu", [
                ["20000","Kuala Terengganu","MY-339"],
                ["21000","Terengganu","MY-340"],
                ["21400","Bukit Payong","MY-341"],
                ["21450","Chalok","MY-342"],
                ["21500","Sungai Tong","MY-343"],
                ["21600","Marang","MY-344"],
                ["21700","Kuala Berang","MY-345"],
                ["21800","Ajil","MY-346"],
                ["22000","Jerteh","MY-347"],
                ["22100","Permaisuri","MY-348"],
                ["22200","Kampung Raja","MY-349"],
                ["22300","Kuala Besut","MY-350"],
                ["22300","Kuala Besut","MY-351"],
                ["23000","Dungun","MY-352"],
                ["23100","Paka","MY-353"],
                ["23200","Bukit Besi","MY-354"],
                ["23200","Bukit Besi","MY-355"],
                ["23300","Ketengah Jaya","MY-356"],
                ["23400","Al Muktatfi Billah Shah","MY-357"],
                ["24000","Cukai","MY-358"],
                ["24050","Ayer Puteh","MY-359"],
                ["24060","Ceneh","MY-360"],
                ["24100","Kijal","MY-361"],
                ["24200","Kemasek","MY-362"],
                ["24300","Kerteh","MY-363"]
            ]],
            ["MY","SBH","Sabah", [
                ["88000","Kota Kinabalu","MY-364"],
                ["88700","Beverly","MY-365"],
                ["88721","Putatan","MY-366"],
                ["88856","Likas","MY-367"],
                ["88857","Inanam","MY-368"],
                ["88858","Tanjung Aru","MY-369"],
                ["89000","Keningau","MY-370"],
                ["89050","Kudat","MY-371"],
                ["89100","Kota Marudu","MY-372"],
                ["89150","Kota Belud","MY-373"],
                ["89200","Tuaran","MY-374"],
                ["89250","Tamparuli","MY-375"],
                ["89260","Tenghilan","MY-376"],
                ["89300","Ranau","MY-377"],
                ["89500","Penampang","MY-378"],
                ["89600","Papar","MY-379"],
                ["89650","Tambunan","MY-380"],
                ["89700","Bongawan","MY-381"],
                ["89720","Membakut","MY-382"],
                ["89740","Kuala Penyu","MY-383"],
                ["89760","Menumbok","MY-384"],
                ["89800","Beaufort","MY-385"],
                ["89850","Sipitang","MY-386"],
                ["89900","Tenom","MY-387"],
                ["89950","Nabawan","MY-388"],
                ["90000","Sandakan","MY-389"],
                ["90100","Beluran","MY-390"],
                ["90200","Kota Kinabatangan","MY-391"],
                ["90400","Pamol","MY-392"],
                ["91000","Tawau","MY-393"],
                ["91100","Lahad Datu","MY-394"],
                ["91200","Kunak","MY-395"],
                ["91300","Semporna","MY-396"],
            ]],
            ["MY","SRW","Sarawak", [
                ["93000","Kuching","MY-397"],
                ["94000","Bau","MY-398"],
                ["94200","Siburan","MY-399"],
                ["94300","Kota Samarahan","MY-400"],
                ["94500","Lundu","MY-401"],
                ["94600","Asajaya","MY-402"],
                ["94700","Serian","MY-403"],
                ["94800","Simunjan","MY-404"],
                ["94850","Sebuyau","MY-405"],
                ["94900","Lingga","MY-406"],
                ["94950","Pusa","MY-407"],
                ["95000","Sri Aman","MY-408"],
                ["95300","Roban","MY-409"],
                ["95400","Saratok","MY-410"],
                ["95500","Debak","MY-411"],
                ["95600","Spaoh","MY-412"],
                ["95700","Betong","MY-413"],
                ["95800","Engkilili","MY-414"],
                ["95900","Lubok Antu","MY-415"],
                ["96000","Sibu","MY-416"],
                ["96100","Sarikei","MY-417"],
                ["96150","Belawai","MY-418"],
                ["96200","Daro","MY-419"],
                ["96250","Matu","MY-420"],
                ["96300","Dalat","MY-421"],
                ["96350","Balingian","MY-422"],
                ["96400","Mukah","MY-423"],
                ["96500","Bintangor","MY-424"],
                ["96600","Julau","MY-425"],
                ["96700","Kanowit","MY-426"],
                ["96800","Kapit","MY-427"],
                ["96850","Song","MY-428"],
                ["97000","Bintulu","MY-429"],
                ["97100","Sebauh","MY-430"],
                ["97200","Tatau","MY-431"],
                ["97300","Bintulu","MY-432"],
                ["98000","Miri","MY-433"],
                ["98050","Baram","MY-434"],
                ["98100","Lutong","MY-435"],
                ["98150","Bekenu","MY-436"],
                ["98200","Niah","MY-437"],
                ["98300","Long Lama","MY-438"],
                ["98700","Limbang","MY-439"],
                ["98750","Nanga Medamit","MY-440"],
                ["98800","Sundar","MY-441"],
                ["98850","Lawas","MY-442"],
            ]],
            ["MY","KUL","Wilayah Persekutuan Kuala Lumpur", [
                ["50000","Kuala Lumpur","MY-443"]
            ]],
            ["MY","LBN","Wilayah Persekutuan Labuan", [
                ["87000","Labuan","MY-444"]
            ]],
            ["MY","PJY","Wilayah Persekutuan Putra Jaya", [
                ["62000","Putrajaya","MY-445"],
            ]],
        ];
    }

    private function deleteExistingRegionData()
    {
        $adapter = $this->moduleDataSetup->getConnection();
        $adapter->delete(
            $adapter->getTableName('directory_country_region'),
            [
                'country_id = ?' => 'MY',
            ]
        );
    }

}

