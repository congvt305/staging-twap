<?php
/** @var $viewModel \Eguana\Magazine\ViewModel\Index\MagazineList */
$viewModel = $block->getData('view_model_list');
$bannerCollection = $viewModel->getBannerThumbnail();
$imageMagazineCollection = $viewModel->getImageMagazineCollection();
$videoThumbnail = $viewModel->getVideoThumbnail();
$magazineCollection = $viewModel->getMagazineTotalCollection();
?>
<div class="block magazine-image">
    <?php if (!empty($bannerCollection->getData())):?>
        <?php foreach ($bannerCollection as $magazineItem): ?>
            <div class="magazine-photo-banner">
                <a class="action view"
                   href="<?= $block->escapeHtml($block->getUrl($viewModel->getItemDetailsUrl($magazineItem['entity_id'])));?>">
                    <span>
                        <img src="<?= $block->escapeHtml($viewModel->getThumbnailSrc($magazineItem['thumbnail_image']));?>"
                             alt="<?= $block->escapeHtml($magazineItem['thumbnail_alt']);?>" />
                    </span>
                </a>
                <h1><?= $block->escapeHtml($magazineItem['show_date']);?></h1>
            </div>
        <?php endforeach; ?>
    <?php endif;?>
    <?php if (!empty($imageMagazineCollection->getData())):?>
        <ul class="list-image-box"">
            <?php foreach ($imageMagazineCollection as $magazineItem): ?>
            <li class="magazine-item-box">
                <div class="magazine-item">
                    <a
                        href="<?= $block->escapeHtml($block->
                        getUrl($viewModel->getItemDetailsUrl($magazineItem['entity_id'])));?>">
                            <span>
                                <img src="<?= $block->escapeHtml($viewModel->
                                getThumbnailSrc($magazineItem['thumbnail_image']));?>"
                                     alt="<?= $block->escapeHtml($magazineItem['thumbnail_alt']);?>" />
                            </span>
                    </a>
                    <h1><?= $block->escapeHtml($magazineItem['show_date']);?></h1>
                    <div class="block-title">
                        <strong><?= $block->escapeHtml($magazineItem['title']) ?></strong>
                    </div>
                    <div class="short-discription">
                        <span><?= $block->escapeHtml($magazineItem['content_short']) ?></span>
                    </div>
                </div>
            </li>
        <?php endforeach; ?>
        </ul>
    <?php endif;?>
    <div class="block magazine-video">
        <?php if (!empty($videoThumbnail->getData())):?>
            <?php foreach ($videoThumbnail as $magazineItem): ?>
                <div class="magazine-video-banner">
                    <a class="action view"
                       href="<?= $block->escapeHtml($block->getUrl($viewModel->getItemDetailsUrl($magazineItem['entity_id'])));?>">
                        <span>
                            <img src="<?= $block->escapeHtml($viewModel->getThumbnailSrc($magazineItem['thumbnail_image']));?>"
                                 alt="<?= $block->escapeHtml($magazineItem['thumbnail_alt']);?>" />
                        </span>
                    </a>
                    <h1><?= $block->escapeHtml($magazineItem['show_date']);?></h1>
                </div>
            <?php endforeach; ?>
        <?php endif;?>
        <div class="block-title other-magazine">
            <strong><?= $block->escapeHtml(__('Other Magazines')) ?></strong>
        </div>
        <?php if (!empty($magazineCollection->getData())):?>
            <ul class="magazine-slider" id="slick">
            <?php $date = '' ?>
            <?php foreach ($magazineCollection as $magazineItem): ?>
                <?php if ($date == '' || $magazineItem['show_date'] < $date):?>
                <?php $magazine = $viewModel->getSliderThumnai($magazineItem['show_date'])->getData(); ?>
                    <li class="magazine-slider-item">
                        <div class="magazine-item">
                            <a
                                href="<?= $block->escapeHtml($block->
                                getUrl($viewModel->getMonthlyMagazineUrl($magazine[0]['show_date'])));?>">
                    <span>
                        <img src="<?= $block->escapeHtml($viewModel->
                        getThumbnailSrc($magazine[0]['thumbnail_image']));?>"
                             alt="<?= $block->escapeHtml($magazine[0]['thumbnail_alt']);?>" />
                    </span>
                            </a>
                            <h1><?= $block->escapeHtml($magazine[0]['show_date']);?></h1>
                        </div>
                    </li>
                    <?php $date = $viewModel->getMonthFromDate($magazineItem['show_date']) ?>
                <?php endif;?>
            <?php endforeach; ?>
        </ul>
        <?php endif;?>
    </div>
</div>
<script>
    require([
        'jquery',
        'slick'
    ], function ($) {

        $('#slick').slick({
            dots: false,
            infinite: false,
            speed: 300,
            slidesToShow: 4,
            slidesToScroll: 1,
            marginRight: '30px',
            responsive: [
                {
                    breakpoint: 1024,
                    settings: {
                        slidesToShow: 3,
                        slidesToScroll: 1,
                        infinite: true,
                        dots: true
                    }
                },
                {
                    breakpoint: 600,
                    settings: {
                        slidesToShow: 2,
                        slidesToScroll: 1
                    }
                },
                {
                    breakpoint: 480,
                    settings: {
                        slidesToShow: 1,
                        slidesToScroll: 1
                    }
                }
            ]
        });
    });
</script>
