<?php
/**
 * Created by Eguana.
 * User: Brian
 * Date: 2020-11-10
 * Time: 오전 11:01
 */
/** @var $block \Amore\PointsIntegration\Block\Points\Index */
$pointSearchResult = $block->getPointsSearchResult();
?>
<div class="block block-points-integration">
    <div class="block-title">
        <strong><?= __('Integration Points'); ?></strong>
    </div>
    <div class="block-content content">
        <?php if (count($pointSearchResult) > 0) : ?>
            <div class="pos-customer-info">
                <div class="pos-customer-name">
                    <strong><?= $block->escapeHtml(__('Name')) . ' : '; ?><?= $pointSearchResult['lastName'] . $pointSearchResult['firstName']; ?></strong>
                </div>
                <div class="pos-customer-integration-code">
                    <span><?= $block->escapeHtml(__('Customer Code')) . ' : '; ?><?= $pointSearchResult['cstmIntgSeq']; ?></span>
                </div>
                <div class="pos-customer-grade-code">
                    <?= $block->escapeHtml(__('Customer Grade Code')) . ' : '; ?>
                    <?= $pointSearchResult['cstmGradeCD']; ?>
                </div>
                <div class="pos-customer-grade-name">
                    <?= $block->escapeHtml(__('Customer Grade')) . ' : '; ?>
                    <?= $pointSearchResult['cstmGradeNM']; ?>
                </div>
                <div class="pos-customer-available-points">
                    <?= $block->escapeHtml(__('Available Points')) . ' : '; ?>
                    <?= $pointSearchResult['availablePoint']; ?>
                    <a id="points-modal-info" type="button" class="action" data-trigger="trigger">
                        <span data-bind="i18n: 'Point Guideline'"></span>
                    </a>
                    <div data-bind="mageInit: {
                    'Magento_Ui/js/modal/modal':{
                        'type': 'popup',
                        'title': jQuery.mage.__('Points Policy'),
                        'trigger': '[data-trigger=trigger]',
                        'responsive': true,
                        'buttons': [{
                            text: jQuery.mage.__('Confirm'),
                            class: 'agree button action primary'
                        }]
                    }}">
                        <div id="points-modal" class="content">
                            <?php
                                $pointsModalCmsBlock = $block->getLayout()->createBlock('Magento\Cms\Block\Block')->setBlockId('point_policy_modal_block')->toHtml();
                            ?>
                            <?php if ($pointsModalCmsBlock): ?>
                                <div class="modal-block">
                                    <div class="modal-block-content">
                                        <?= $pointsModalCmsBlock; ?>
                                    </div>
                                </div>
                            <?php endif;?>
                        </div>
                    </div>
                </div>
                <div class="pos-customer-expire-points">
                    <?= $block->escapeHtml(__('Expire Points')) . ' : '; ?>
                    <?= $pointSearchResult['expirePoint']; ?>
                </div>
                <div class="pos-customer-expireDate">
                    <?= $block->escapeHtml(__('Expiry Date')) . ' : '; ?>
                    <?= $block->dateFormat($pointSearchResult['expireDate']); ?>
                </div>
            </div>
        <?php else : ?>
            <div class="message info empty">
                <span><?= $block->escapeHtml(__('Customer Points Info is not Exist.')) ?></span>
            </div>
        <?php endif ?>
    </div>
</div>
